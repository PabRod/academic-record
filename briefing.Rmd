---
title: "Academic activity"
author: "Pablo Rodríguez"
date: "March 12, 2018"
output: html_document
---

```{r Setup, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(knitr.kable.NA = '-')
```

```{r Dependencies, warning=FALSE, message=FALSE}
rm(list = ls())
source('auxs.R')
library(knitr)
library(dplyr)
library(ggplot2)
library(sp)
```


```{r Load, warning=FALSE, message=FALSE}
key <- "1DVLcKvMLVrdkn2kRO-X-_KADaqVnhM4yyWddP-UN-40"
data <- parse_academic_production(key)
```

```{r Backups}
save(data, file='backup.Rda')
write.csv(data, file='backup.csv', fileEncoding='UTF-8')
```

```{r Filter, warning=FALSE}
data_table <- select(data, Date, Name, Type, Language)
```

## Secondments
```{r Secondments}
secs <- filter(data, Type == 'Secondment')
secs <- select(secs, Date, End.date, Name, Institution)
secs <- mutate(secs, Duration = round(difftime(End.date, Date, units='weeks')))

secs_duration <- sum(secs$Duration)
```

I've spent `r secs_duration` weeks in secondments, distributed as the following:

```{r SecondmentsTab}
kable(secs, format='markdown')
```

## Talks and classes given
```{r Talks}
talks <- filter(data, grepl('Pablo Rodríguez', Author), Type == 'Seminar' | Type == 'Congress' | Type == 'Course')
talks <- select(talks, Date, End.date, Name, Institution)
kable(talks, format='markdown')
```

## Science communication activity
```{r Scicomm}
sci_comm <- filter(data, Type == 'Article')
sci_comm_table <- select(sci_comm, Date, NameURL, Institution, Language)

n_spanish <- nrow(filter(sci_comm, Language == 'Spanish'))
n_english <- nrow(filter(sci_comm, Language == 'English'))
```

Up to date, I've published `r nrow(sci_comm)` science communication essays: `r n_english` in english, and `r n_spanish` in spanish language.

```{r ScicommDates}
hist(sci_comm$Date, breaks=20)
```

Science communication publications in english:

```{r ScicommEnglish}
kable(select(filter(sci_comm_table, Language == 'English'), Date, NameURL, Institution), format='markdown')
```

Latest science communication publications:

```{r ScicommTab}
kable(head(sci_comm_table), format='markdown')
```

```{r ScicommDist}
ggp <- ggplot(sci_comm, aes(x=Institution))
ggp <- ggp + geom_bar(fill='red') + ggtitle('Science communication essays')
ggp <- ggp + xlab('Publisher') + ylab('Amount')

ggp
```

## Visited countries

You can also embed plots, for example:

```{r Map, warning=FALSE, message=FALSE}
map <- plot_map(data$Country)
```

***

Built with R `r getRversion()` and RStudio.

<!-- TODO: publish in GitHub --> 